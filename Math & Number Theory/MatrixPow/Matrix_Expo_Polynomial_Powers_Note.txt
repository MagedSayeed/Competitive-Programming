
ğŸ“Œ Matrix Exponentiation for Recurrence with Polynomial Term (i+1)^k

âœ… Goal:
Compute values of the form:
    dp[i+1] = dp[i] + (i+1)^k

This leads to:
    dp[n] = âˆ‘_{i=0}^{n-1} (i+1)^k = âˆ‘_{i=1}^{n} i^k
Or equivalently:
    âˆ‘_{i=0}^{n} i^k = dp[n+1], where dp[0] = 0

ğŸ§  Idea:
Use matrix exponentiation to compute dp[n+1] efficiently in O(k^3 log n) time.

ğŸ—ï¸ State Vector:
Let the state vector be of size (k + 2):
    State[i] = [dp[i], i^0, i^1, ..., i^k]

ğŸ§± Transition Matrix (size (k+2) x (k+2)):
We build a square matrix M such that:
    State[i+1] = M Ã— State[i]

Structure:
- Row 0: computes dp[i+1] = dp[i] + i^k
    â†’ Row[0][0] = 1 (carry dp[i])
    â†’ Row[0][k+1] = 1 (add i^k)
- Rows 1 to k+1: compute powers using binomial expansion of (i+1)^j
    â†’ Row[r] = binomial coefficients of (i+1)^{r-1}

ğŸ§ª Example: dp[i+1] = dp[i] + (i+1)^2
This computes: dp[n+1] = âˆ‘_{i=0}^n (i+1)^2 = âˆ‘_{i=1}^{n+1} i^2

Use 4x4 matrix (k = 2):

State Vector:
    State[i] = [dp[i], i^0, i^1, i^2]

Transition Matrix M:
    [ 1  0  0  1 ]   â† dp[i+1] = dp[i] + i^2
    [ 0  1  0  0 ]   â† i^0 stays 1
    [ 0  1  1  0 ]   â† i^1 = i + 1
    [ 0  1  2  1 ]   â† i^2 = i^2 + 2i + 1

Initial Vector:
    dp[0] = 0, i = 0 â‡’ [0, 1, 0, 0]

To compute:
    âˆ‘_{i=0}^{n} i^2 = dp[n+1]

ğŸ“Œ Final Summary:
- Matrix size = k + 2
- State vector = [dp[i], i^0, i^1, ..., i^k]
- Use binomial expansion for polynomial update
- Result is in State[n+1][0]
